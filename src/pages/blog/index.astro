---
import { getCollection } from 'astro:content'

import BaseLayout from '@/layouts/BaseLayout.astro'
import BlogPost from '@/components/BlogPost.astro'

// Get all posts and sort by date (newest first)
const allPosts = await getCollection('blog')
const sortedPosts = allPosts.sort(
    (a, b) => b.data.date.getTime() - a.data.date.getTime()
)

const pageTitle = 'Blog'
---

<BaseLayout pageTitle={pageTitle}>
    <div class='mx-auto max-w-4xl'>
        <!-- Header -->
        <header class='mb-12 text-center'>
            <h1 class='mb-4 text-3xl font-bold md:text-4xl'>{pageTitle}</h1>
            <p class='text-yang/80 dark:text-yin/80 mx-auto max-w-2xl text-lg'>
                Thoughts, stories, and ideas about web development, programming,
                and technology.
            </p>
        </header>

        <!-- Posts List -->
        <ul class='divide-yang/10 dark:divide-yin/10 divide-y'>
            {
                sortedPosts.map((post) => (
                    <BlogPost
                        url={`/blog/${post.id}/`}
                        title={post.data.title}
                        date={post.data.date}
                        description={post.data.description}
                        tags={post.data.tags}
                        author={post.data.author}
                    />
                ))
            }
        </ul>
    </div>
</BaseLayout>
